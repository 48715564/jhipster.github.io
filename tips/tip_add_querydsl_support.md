Add QueryDSL support
------------------------

In some cases spring-data [query possibilities](http://docs.spring.io/spring-data/mongodb/docs/current/reference/html/#mongodb.repositories.queries)  
are not enough to make your queries. You can use @Query annotation and [write your own](http://docs.spring.io/spring-data/mongodb/docs/current/reference/html/#mongodb.repositories.queries.json-based)
Some of us like to write type safe queries like [QueryDSL](http://www.querydsl.com/) provides.


### Generated Predicate classes

An important part of QueryDSL are generated domain classes for queries so called Predicate. In case of spring-data-mongodb these are generated by the Java annotation post processing tool.

### Gradle plugin
There is also Gradle plugin for querydsl which supports configuration for spring-data-mongodb.

### Maven
There is also plugin for maven. But in this `tip` we describe only `gradle` configuration.

## Changes

### build.gradle


Add the `queryDsl plugin` configuration `grunt.initConfig`

```javascript

buildscript {
  repositories {
    jcenter()
  }

  dependencies {
    classpath "com.ewerk.gradle.plugins:querydsl-plugin:1.0.3"
  }
}

apply plugin: "com.ewerk.gradle.plugins.querydsl"

querydsl {
  // we use mongodb 
  springDataMongo = true
}

compile "com.mysema.querydsl:querydsl-mongodb:3.6.0"

```
*Note* we use mongodb but queryDSL plugin supports also [more options](https://github.com/ewerk/gradle-plugins/tree/master/querydsl-plugin).

If you run `gradle build` you will see output like this
`Note: Generating net.jogat.names.domain.QName for [net.jogat.names.domain.Name]`

For every domain class which is annotated with @Document queryDSL plugin will generate one Predicate class.

### Change Repository classes
If you have a domain class for example Name.class ,than you have also NameRepository class.
You have to change every Repository class to extend from `QueryDslPredicateExecutor`.

```Java

public interface NameRepository extends MongoRepository<Name, String>, QueryDslPredicateExecutor<Name> {

```

This will extend your repository class with extra methods supporting QueryDSL ([see](http://docs.spring.io/spring-data/mongodb/docs/current/reference/html/#mongodb.repositories.queries.type-safe) )

## Write type safe query

Gradle plugin has generated class QName which can be used for writing queries for Name.class. Here is Java example.
```Java

QName name = new QName("name");

// count all names whose list "categorie" contains string "TOP_EVER"
nameRepository.count(name.categories.contains("TOP_EVER"));

```