---
layout: default
title: Deploying to Heroku
sitemap:
    priority: 0.7
    lastmod: 2014-09-08T00:00:00-00:00
---

<h1><i class="fa fa-cloud-upload"></i> [BETA] Deploying to Heroku</h1>

<p><b>WARNING!</b> This is a new sub-generator, of <b>BETA</b> quality. Use it at your own risk! Feedback is highly welcome!</p>

<p>This sub-generator allows to deploy automatically your JHipster application to the <a href="https://www.heroku.com/" target="_blank">Heroku cloud</a>.</p>

<h2>Limitations</h2>
<p>
This sub-generator has a few limitations:
<ul>
    <li>You can only use it with a Postgresql database, as this is what Heroku provides by default</li>
    <li>You can only use it with the Grunt option (which is the recommended default), as it's the only one providing tasks for deploying</li>
    <li>You can use it with either Maven or Gradle</li>
    <li>If your application is killed by Heroku when your Liquibase changelog is being applied, your database will be marked as "locked" by Liquibase. You will need to manually clean the lock table</li>
</ul>
</p>

<h2>Running the sub-generator</h2>

<p>
    Before running the sub-generator, you need to install the <a href="https://toolbelt.heroku.com/" target="_blank">Heroku toolbelt</a>, and have a Heroku account created.
</p>

<p>
    Be sure that you got logged on Heroku following the documentation, in section getting started:
</p>
<code>
    heroku login <br />
    Enter your Heroku credentials. <br />
    Email: YOUR_EMAIL <br />
    Password (typing will be hidden): YOUR_PASSWORD <br />
    Authentication successful.
</code>


<p>
    To deploy your application to Heroku, type:
</p>
<p>
<code>
yo jhipster:heroku
</code>
</p>
<p>
    This should package your application in "production" mode, create an Heroku application (with a Postgresql database), upload your code, and start the application.
</p>

<p><i>Please be aware that your application must start under 60 seconds, or it will be killed. Depending on the platform load, starting under 60 seconds is of course not guaranteed!</i></p>

<h2>Updating your deployed application</h2>
<p>
    When your application is already deployed, you can prepare a new deployment by typing:
</p>
<p>
<code>
grunt deployHeroku
</code>
</p>
<p>
    Then you can check your application, which is ready for deployment, in your "deploy/heroku" folder. If you are ready to deploy, you can push it to production, by typing (in your "deploy/heroku" folder):
</p>
<p>
<code>
git push
</code>
</p>

<h2>Deploying without Git</h2>
<p>
  In lieu of using the "deploy/heroku" folder, you may use the Heroku Deploy plugin to deploy the executable WAR file
  generated by your build process. To begin, install the plugin by running this command.
</p>
<p>
<code>
heroku plugins:install https://github.com/heroku/heroku-deploy
</code>
</p>
<p>
  Then run your build process, and deploy the app with this command:
</p>
<p>
<code>
heroku deploy:jar --jar target/*.war --options "--spring.profiles.active=prod --server.port=\$PORT --spring.datasource.heroku-url=\$DATABASE_URL"
</code>
</p>

<h2>Troubleshooting</h2>

<p>
  If your app is hanging at boot-time with the message "Configuring Liquibase", then try running the following command:
</p>
<p>
<code>
$ heroku pg:psql -c "update databasechangeloglock set locked=false;"
</code>
</p>
<p>
  Heroku has a default boot-timeout limit of 60 seconds. If your Liquibase configuration
  takes longer than this, Heroku will kill the process, which leaves the database in a
  locked state. If the problem is persistent, try contacting
  <a href="http://help.heroku.com">Heroku Support</a> to request a longer boot limit for your app.
</p>

<p>
  If you see errors about MySQL, ensure that you have the following config in your
  src/main/resources/config/application-prod.yml
</p>
<p>
<pre>
spring:
  profiles:
    active: prod
  datasource:
    dataSourceClassName: org.postgresql.ds.PGSimpleDataSource
    cachePrepStmts: true
    prepStmtCacheSize: 250
    prepStmtCacheSqlLimit: 2048
    useServerPrepStmts: true
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQL82Dialect
    database: POSTGRESQL
</pre>
</p>

<h2>More information</h2>

<p>
    <ul>
        <li><a href="https://github.com/kissaten/jhipster-example" target="_blank">Example Application</a>
        <li><a href="http://docs.spring.io/spring-boot/docs/current/reference/html/cloud-deployment-heroku.html" target="_blank">Spring Boot Heroku documentation</a></li>
    </ul>
</p>
